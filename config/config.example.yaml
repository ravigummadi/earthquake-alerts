# Earthquake Alerts Configuration
# Copy this file to config.yaml and customize for your deployment

# How often to check for new earthquakes (used by Cloud Scheduler)
polling_interval_seconds: 60

# How far back to look for earthquakes on each poll
lookback_hours: 1

# Minimum magnitude to fetch from USGS (reduces API load)
min_fetch_magnitude: 2.0

# Firestore database name (use "earthquake-alerts" for the created database)
# Leave commented to use default database
firestore_database: earthquake-alerts

# Firestore collection for storing alerted earthquake IDs
firestore_collection: earthquake_alerts

# Geographic regions to monitor
monitoring_regions:
  - name: "Bay Area"
    bounds:
      min_latitude: 35.9024
      max_latitude: 39.18543
      min_longitude: -122.92603
      max_longitude: -120.71777

# Points of interest for proximity alerts
points_of_interest:
  - name: "SF Office"
    latitude: 37.7749
    longitude: -122.4194
    alert_radius_km: 50

  - name: "Oakland Office"
    latitude: 37.8044
    longitude: -122.2712
    alert_radius_km: 30

# Notification channels with their alert rules
alert_channels:
  # Critical alerts - only significant earthquakes
  - name: "earthquake-critical"
    type: slack
    # Use Secret Manager (recommended for production)
    webhook_url: "${secret:slack-webhook-critical}"
    # Or use environment variable
    # webhook_url: "${SLACK_WEBHOOK_CRITICAL}"
    rules:
      min_magnitude: 5.0
      bounds:
        min_latitude: 35.9024
        max_latitude: 39.18543
        min_longitude: -122.92603
        max_longitude: -120.71777
      alert_on_tsunami: true
      alert_on_felt: true
      felt_threshold: 500

  # All alerts - any notable earthquake in the region
  - name: "earthquake-all"
    type: slack
    webhook_url: "${secret:slack-webhook-all}"
    rules:
      min_magnitude: 3.0
      bounds:
        min_latitude: 35.9024
        max_latitude: 39.18543
        min_longitude: -122.92603
        max_longitude: -120.71777

  # Proximity alerts - earthquakes near our offices
  - name: "earthquake-nearby"
    type: slack
    webhook_url: "${secret:slack-webhook-nearby}"
    rules:
      min_magnitude: 2.5
      points_of_interest:
        - "SF Office"
        - "Oakland Office"

  # Twitter/X alerts - public earthquake notifications
  # Requires Twitter Developer API credentials (https://developer.twitter.com)
  - name: "quake-alerts-twitter"
    type: twitter
    credentials:
      api_key: "${secret:twitter-api-key}"
      api_secret: "${secret:twitter-api-secret}"
      access_token: "${secret:twitter-access-token}"
      access_token_secret: "${secret:twitter-access-token-secret}"
    rules:
      min_magnitude: 2.5
      bounds:
        min_latitude: 35.9024
        max_latitude: 39.18543
        min_longitude: -122.92603
        max_longitude: -120.71777

  # WhatsApp alerts via Twilio
  # Requires Twilio account with WhatsApp enabled (https://www.twilio.com/whatsapp)
  - name: "earthquake-whatsapp"
    type: whatsapp
    credentials:
      account_sid: "${secret:twilio-account-sid}"
      auth_token: "${secret:twilio-auth-token}"
      from_number: "+14155238886"  # Twilio WhatsApp sandbox or your number
      to_numbers:
        - "+1234567890"  # Recipient phone numbers
        - "+0987654321"
    rules:
      min_magnitude: 4.0
      bounds:
        min_latitude: 35.9024
        max_latitude: 39.18543
        min_longitude: -122.92603
        max_longitude: -120.71777
